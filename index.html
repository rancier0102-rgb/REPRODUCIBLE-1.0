<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>IPTV Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { background: #111; color: white; font-family: Arial; padding: 20px; }
        video { width: 100%; max-width: 800px; background: #000; }
        .channel { padding: 10px; margin: 5px; background: #333; cursor: pointer; border-radius: 5px; display: inline-block; }
        .channel:hover { background: #e94560; }
        select, button { padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ðŸ“º IPTV Player</h1>
    
    <div id="channels">
        <div class="channel" onclick="play('http://1tv41.icu:8080/live/tandphunt1@gmail.com/AAn4BJhH7f/159953.ts')">PO GS</div>
        <div class="channel" onclick="play('http://1tv41.icu:8080/live/tandphunt1@gmail.com/AAn4BJhH7f/159954.ts')">POR</div>
        <div class="channel" onclick="play('http://1tv41.icu:8080/live/tandphunt1@gmail.com/AAn4BJhH7f/159955.ts')">PO X</div>
        <div class="channel" onclick="play('http://1tv41.icu:8080/live/tandphunt1@gmail.com/AAn4BJhH7f/159956.ts')">PO</div>
        <div class="channel" onclick="play('http://1tv41.icu:8080/live/tandphunt1@gmail.com/AAn4BJhH7f/159957.ts')">P</div>
    </div>

    <br>
    <video id="video" controls autoplay></video>
    <p id="status">Selecciona un canal</p>

    <script>
        const video = document.getElementById('video');
        const status = document.getElementById('status');
        
        // Lista de proxies CORS (si uno falla, prueba otro)
        const proxies = [
            'https://corsproxy.io/?',
            'https://api.allorigins.win/raw?url=',
            'https://cors-anywhere.herokuapp.com/',
            'https://thingproxy.freeboard.io/fetch/'
        ];
        
        let currentProxy = 0;

        function play(url) {
            status.textContent = 'Cargando...';
            
            // Intentar reproducciÃ³n directa primero
            tryPlay(url);
        }

        function tryPlay(originalUrl) {
            const proxyUrl = proxies[currentProxy] + encodeURIComponent(originalUrl);
            
            // Para streams .ts usar reproducciÃ³n directa
            if (originalUrl.endsWith('.ts')) {
                video.src = proxyUrl;
                video.play().then(() => {
                    status.textContent = 'Reproduciendo: ' + originalUrl.split('/').pop();
                }).catch(e => {
                    tryNextProxy(originalUrl);
                });
            } 
            // Para .m3u8 usar HLS.js
            else if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(proxyUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    video.play();
                    status.textContent = 'Reproduciendo';
                });
                hls.on(Hls.Events.ERROR, () => {
                    tryNextProxy(originalUrl);
                });
            }
        }

        function tryNextProxy(url) {
            currentProxy++;
            if (currentProxy < proxies.length) {
                status.textContent = 'Probando proxy alternativo...';
                tryPlay(url);
            } else {
                currentProxy = 0;
                status.textContent = 'Error: No se puede reproducir. Prueba con VLC.';
            }
        }
    </script>
</body>
</html>
